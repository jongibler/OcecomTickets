@model IEnumerable<OcecomTickets.Models.Ticket>

@{
    ViewBag.Title = "Tickets";
}

<h2>Tickets</h2>

<p>
    @Html.ActionLink("Crear Nuevo Ticket", "Create")
</p>

<hr />

<ul class="nav nav-tabs" role="tablist">
    <li role="presentation" class="active">
        <a href="#open" aria-controls="open" role="tab" data-toggle="tab">Abiertos</a>
    </li>
    <li role="presentation">
        <a href="#inprogress" aria-controls="inprogress" role="tab" data-toggle="tab">En Progreso</a>
    </li>
    <li role="presentation">
        <a href="#closed" aria-controls="closed" role="tab" data-toggle="tab">Cerrados</a>
    </li>
</ul>

<div class="tab-content">
    <div role="tabpanel" class="tab-pane active" id="open">
        <div style="overflow-x:auto; margin-top:15px;">
            <table class="table table-striped table-responsive">
                <tr>
                    @if (User.IsInRole("Admin") || User.IsInRole("Employee"))
                    {
                        <th>Cliente</th>
                    }
                    <th>Fecha</th>
                    <th>Severidad</th>
                    <th>Categoría</th>
                    <th>Nota</th>
                    <th></th>
                </tr>

                @foreach (var item in Model.Where(t => t.Status == "Abierto"))
                {
                    <tr>
                        @if (User.IsInRole("Admin") || User.IsInRole("Employee"))
                {
                            <td>
                                @Html.DisplayFor(modelItem => item.Client.ClientName)
                            </td>
                        }
                        <td>
                            @Html.DisplayFor(modelItem => item.CreationDate)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Severity)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Category)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Note)
                        </td>
                        <td>
                            @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                            @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                            @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                        </td>
                    </tr>
                }
            </table>
        </div>
    </div>

    <div role="tabpanel" class="tab-pane" id="inprogress">
        <div style="overflow-x:auto; margin-top:15px;">
            <table class="table table-striped table-responsive">
                <tr>
                    @if (User.IsInRole("Admin") || User.IsInRole("Employee"))
                    {
                        <th>Cliente</th>
                    }
                    <th>Fecha</th>
                    <th>Severidad</th>
                    <th>Categoría</th>
                    <th>Nota</th>
                    <th></th>
                </tr>

                @foreach (var item in Model.Where(t => t.Status == "En Progreso"))
                {
                    <tr>
                        @if (User.IsInRole("Admin") || User.IsInRole("Employee"))
                        {
                            <td>
                                @Html.DisplayFor(modelItem => item.Client.ClientName)
                            </td>
                        }
                        <td>
                            @Html.DisplayFor(modelItem => item.CreationDate)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Severity)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Category)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Note)
                        </td>
                        <td>
                            @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                            @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                            @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                        </td>
                    </tr>
                }
            </table>
        </div>
    </div>

    <div role="tabpanel" class="tab-pane" id="closed">
        <div style="overflow-x:auto; margin-top:15px;">
            <table class="table table-striped table-responsive">
                <tr>
                    @if (User.IsInRole("Admin") || User.IsInRole("Employee"))
                    {
                        <th>Cliente</th>
                    }
                    <th>Fecha</th>
                    <th>Severidad</th>
                    <th>Categoría</th>
                    <th>Nota</th>
                    <th></th>
                </tr>

                @foreach (var item in Model.Where(t => t.Status == "Cerrado"))
                {
                    <tr>
                        @if (User.IsInRole("Admin") || User.IsInRole("Employee"))
                {
                            <td>
                                @Html.DisplayFor(modelItem => item.Client.ClientName)
                            </td>
                        }
                        <td>
                            @Html.DisplayFor(modelItem => item.CreationDate)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Severity)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Category)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Note)
                        </td>
                        <td>
                            @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                            @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                            @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                        </td>
                    </tr>
                }
            </table>
        </div>
    </div>
</div>
